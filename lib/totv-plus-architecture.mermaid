graph TB
    subgraph "Client Layer - Flutter App"
        A[TOTV+ Mobile App<br/>Flutter + Clean Architecture]
        A1[Presentation Layer<br/>UI Components + Bloc/Cubit]
        A2[Domain Layer<br/>Business Logic + Use Cases]
        A3[Data Layer<br/>Repositories + Models]
        
        A --> A1
        A1 --> A2
        A2 --> A3
    end
    
    subgraph "Security Layer"
        S1[SSL Pinning<br/>Certificate Validation]
        S2[Screen Recording Prevention<br/>FLAG_SECURE]
        S3[DRM Protection<br/>Widevine L1/L3]
        S4[JWT Token Authentication]
        S5[AES-256 Encryption<br/>for JSON Config]
    end
    
    subgraph "Backend Services"
        B1[Firebase Remote Config<br/>Dynamic Content Management]
        B2[Firebase Firestore<br/>User Data + Watchlist]
        B3[Firebase Auth<br/>User Authentication]
        B4[Cloud Storage<br/>Media Metadata + Thumbnails]
        B5[CDN Network<br/>HLS/M3U8 Streaming]
    end
    
    subgraph "Content Management System"
        C1[Admin Dashboard<br/>Web Portal]
        C2[Content Scheduler<br/>Auto-publish]
        C3[Analytics Engine<br/>User Behavior Tracking]
        C4[Push Notifications<br/>FCM]
    end
    
    subgraph "Video Player Engine"
        V1[ExoPlayer Core<br/>HLS + M3U8 Support]
        V2[Adaptive Bitrate Streaming<br/>Auto Quality Switching]
        V3[Subtitle Engine<br/>Multi-language SRT/VTT]
        V4[Offline Download Manager<br/>Encrypted Local Storage]
    end
    
    subgraph "Localization & Geo Services"
        L1[IP Geolocation API<br/>Country Detection]
        L2[Multi-language Support<br/>AR/EN/DE/FR/ES]
        L3[Regional Content Filter<br/>Licensing Rules]
    end
    
    A3 --> S1
    A3 --> S4
    A3 --> S5
    A1 --> S2
    
    S1 --> B1
    S1 --> B2
    S4 --> B3
    S1 --> B4
    
    B1 --> C1
    B2 --> C1
    C1 --> C2
    C1 --> C3
    C1 --> C4
    
    A3 --> V1
    V1 --> V2
    V1 --> V3
    V1 --> V4
    V1 --> B5
    
    A3 --> L1
    L1 --> L2
    L2 --> L3
    L3 --> B1
    
    C4 --> A
    
    style A fill:#FF6B00,stroke:#FF4500,stroke-width:3px,color:#fff
    style A1 fill:#1a1a2e,stroke:#FF6B00,stroke-width:2px,color:#fff
    style A2 fill:#1a1a2e,stroke:#FF6B00,stroke-width:2px,color:#fff
    style A3 fill:#1a1a2e,stroke:#FF6B00,stroke-width:2px,color:#fff
    
    style S1 fill:#dc143c,stroke:#8b0000,stroke-width:2px,color:#fff
    style S2 fill:#dc143c,stroke:#8b0000,stroke-width:2px,color:#fff
    style S3 fill:#dc143c,stroke:#8b0000,stroke-width:2px,color:#fff
    style S4 fill:#dc143c,stroke:#8b0000,stroke-width:2px,color:#fff
    style S5 fill:#dc143c,stroke:#8b0000,stroke-width:2px,color:#fff
    
    style B1 fill:#FFA500,stroke:#FF8C00,stroke-width:2px,color:#fff
    style B2 fill:#FFA500,stroke:#FF8C00,stroke-width:2px,color:#fff
    style B3 fill:#FFA500,stroke:#FF8C00,stroke-width:2px,color:#fff
    style B4 fill:#FFA500,stroke:#FF8C00,stroke-width:2px,color:#fff
    style B5 fill:#FFA500,stroke:#FF8C00,stroke-width:2px,color:#fff
    
    style V1 fill:#00CED1,stroke:#008B8B,stroke-width:2px,color:#fff
    style V2 fill:#00CED1,stroke:#008B8B,stroke-width:2px,color:#fff
    style V3 fill:#00CED1,stroke:#008B8B,stroke-width:2px,color:#fff
    style V4 fill:#00CED1,stroke:#008B8B,stroke-width:2px,color:#fff
