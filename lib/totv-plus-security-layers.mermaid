graph TB
    subgraph "Security Layers - TOTV+"
        direction TB
        
        L1[Layer 1: Network Security]
        L1A[SSL Pinning<br/>Certificate Validation]
        L1B[JWT Token Refresh<br/>Auto-renewal every 30min]
        L1C[API Request Encryption<br/>AES-256-GCM]
        
        L2[Layer 2: App Protection]
        L2A[Root Detection<br/>SafetyNet API]
        L2B[Debugger Detection<br/>Anti-tamper]
        L2C[Code Obfuscation<br/>ProGuard/R8]
        
        L3[Layer 3: Content Security]
        L3A[DRM Protection<br/>Widevine L1/L3]
        L3B[Watermarking<br/>User ID Overlay]
        L3C[Screen Recording Block<br/>FLAG_SECURE]
        
        L4[Layer 4: Data Protection]
        L4A[Encrypted Local Storage<br/>Hive + AES]
        L4B[Secure Config Files<br/>Encrypted JSON]
        L4C[Biometric Auth<br/>Fingerprint/FaceID]
        
        L5[Layer 5: Backend Security]
        L5A[Rate Limiting<br/>API Throttling]
        L5B[IP Whitelisting<br/>Geo-fencing]
        L5C[Firebase Rules<br/>Access Control]
    end
    
    subgraph "Attack Prevention Matrix"
        A1[Man-in-the-Middle<br/>Attack]
        A2[Screen Recording<br/>Theft]
        A3[Video URL<br/>Extraction]
        A4[Credential<br/>Theft]
        A5[Piracy<br/>Distribution]
    end
    
    L1A --> A1
    L1B --> A4
    L1C --> A3
    
    L2A --> A5
    L2B --> A3
    L2C --> A5
    
    L3A --> A5
    L3B --> A5
    L3C --> A2
    
    L4A --> A4
    L4B --> A3
    L4C --> A4
    
    L5A --> A3
    L5B --> A5
    L5C --> A4
    
    style L1 fill:#dc143c,stroke:#8b0000,stroke-width:3px,color:#fff
    style L2 fill:#FF6347,stroke:#dc143c,stroke-width:3px,color:#fff
    style L3 fill:#FF4500,stroke:#FF6347,stroke-width:3px,color:#fff
    style L4 fill:#FF8C00,stroke:#FF4500,stroke-width:3px,color:#fff
    style L5 fill:#FFA500,stroke:#FF8C00,stroke-width:3px,color:#fff
    
    style L1A fill:#1a1a2e,stroke:#dc143c,stroke-width:2px,color:#fff
    style L1B fill:#1a1a2e,stroke:#dc143c,stroke-width:2px,color:#fff
    style L1C fill:#1a1a2e,stroke:#dc143c,stroke-width:2px,color:#fff
    
    style L2A fill:#1a1a2e,stroke:#FF6347,stroke-width:2px,color:#fff
    style L2B fill:#1a1a2e,stroke:#FF6347,stroke-width:2px,color:#fff
    style L2C fill:#1a1a2e,stroke:#FF6347,stroke-width:2px,color:#fff
    
    style L3A fill:#1a1a2e,stroke:#FF4500,stroke-width:2px,color:#fff
    style L3B fill:#1a1a2e,stroke:#FF4500,stroke-width:2px,color:#fff
    style L3C fill:#1a1a2e,stroke:#FF4500,stroke-width:2px,color:#fff
    
    style L4A fill:#1a1a2e,stroke:#FF8C00,stroke-width:2px,color:#fff
    style L4B fill:#1a1a2e,stroke:#FF8C00,stroke-width:2px,color:#fff
    style L4C fill:#1a1a2e,stroke:#FF8C00,stroke-width:2px,color:#fff
    
    style L5A fill:#1a1a2e,stroke:#FFA500,stroke-width:2px,color:#fff
    style L5B fill:#1a1a2e,stroke:#FFA500,stroke-width:2px,color:#fff
    style L5C fill:#1a1a2e,stroke:#FFA500,stroke-width:2px,color:#fff
    
    style A1 fill:#8b0000,stroke:#dc143c,stroke-width:2px,color:#fff
    style A2 fill:#8b0000,stroke:#dc143c,stroke-width:2px,color:#fff
    style A3 fill:#8b0000,stroke:#dc143c,stroke-width:2px,color:#fff
    style A4 fill:#8b0000,stroke:#dc143c,stroke-width:2px,color:#fff
    style A5 fill:#8b0000,stroke:#dc143c,stroke-width:2px,color:#fff
